<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Clients</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <style>
        body{
          background:linear-gradient(135deg,#0d6efd 0%,#6c63ff 100%);
          min-height:100vh;margin:0;display:flex;align-items:flex-start;justify-content:center;
          font-family:'Segoe UI',Roboto,sans-serif;
        }
        .page-wrap{width:100%;max-width:1100px;padding:24px}
        .card{border:none;border-radius:20px;box-shadow:0 8px 30px rgba(0,0,0,.12)}
        .card-header{border:0;border-radius:20px 20px 0 0;background:#fff}
        .btn-rounded{border-radius:10px}
        .avatar{
          width:32px;height:32px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;
          background:#e9f1ff;color:#0d6efd;font-weight:700;margin-right:.5rem
        }
        @media (max-width: 768px){
          .table thead{display:none;}
          .table, .table tbody, .table tr, .table td{display:block;width:100%}
          .table tr{
            margin-bottom:1rem;background:#fff;border-radius:12px;padding:1rem;
            box-shadow:0 4px 12px rgba(0,0,0,.08)
          }
          .table td{
            text-align:right;padding-left:50%;position:relative;border:none!important
          }
          .table td::before{
            content:attr(data-label);position:absolute;left:1rem;width:45%;text-align:left;
            font-weight:600;color:#0d6efd
          }
        }
    </style>
</head>

<body>
<main class="page-wrap">
    <div class="card">
        <div class="card-header d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-2">
            <div>
                <h3 class="mb-0 text-primary">Clients</h3>
                <small class="text-muted">All registered clients</small>
            </div>
            <div class="d-flex gap-2">
                <a class="btn btn-outline-secondary btn-rounded" th:href="@{/}">Home</a>
                <a class="btn btn-primary btn-rounded" th:href="@{/clients/new}">+ New Client</a>
            </div>
        </div>

        <div class="card-body">

            <!-- Filter -->
            <div class="row g-2 mb-3">
                <div class="col-12 col-sm-6 col-lg-4">
                    <input id="clientFilter" type="search" class="form-control" placeholder="Search by name / email / phone..."
                           oninput="filterClients()">
                </div>
            </div>

            <div class="table-responsive">
                <table id="clientTable" class="table table-hover align-middle">
                    <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Client</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>City</th>
                        <th class="text-end">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="c : ${clients}">
                        <td data-label="ID" th:text="${c.id}">1</td>
                        <td data-label="Client">
                            <span class="avatar" th:text="${#strings.substring(c.user.fullName,0,1)}">A</span>
                            <span class="fw-semibold" th:text="${c.user.fullName}">Client Name</span>
                        </td>
                        <td data-label="Email" th:text="${c.user.email}">email@test.com</td>
                        <td data-label="Phone" th:text="${c.phone}">0000000</td>
                        <td data-label="City" th:text="${c.city}">City</td>
                        <td data-label="Actions">
                            <div class="d-flex gap-2 justify-content-end flex-wrap">
                                <a class="btn btn-sm btn-outline-primary btn-rounded"
                                   th:href="@{'/clients/edit/' + ${c.id}}">Edit</a>

                                <form th:action="@{'/clients/delete/' + ${c.id}}" method="post"
                                      onsubmit="return confirm('Delete this client?');">
                                    <button type="submit" class="btn btn-sm btn-outline-danger btn-rounded">Delete</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div th:if="${#lists.isEmpty(clients)}" class="text-center text-muted py-3">
                No registered clients.
            </div>

        </div>
    </div>
</main>

<script>
    function filterClients(){
      const q = (document.getElementById('clientFilter').value || '').toLowerCase();
      const rows = document.querySelectorAll('#clientTable tbody tr');
      rows.forEach(r => {
        const text = r.innerText.toLowerCase();
        r.style.display = text.includes(q) ? '' : 'none';
      });
    }
</script>
</body>
</html>